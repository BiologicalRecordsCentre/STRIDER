<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Use-case: Data Integration â€¢ STRIDER</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use-case: Data Integration">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">STRIDER</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/example_minimal.html">A minimal example</a></li>
    <li><a class="dropdown-item" href="../articles/use_case_colocation.html">Use-case: Investigating the Impact of Sampling Co-location</a></li>
    <li><a class="dropdown-item" href="../articles/use_case_integration.html">Use-case: Data Integration</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Use-case: Data Integration</h1>
            
      

      <div class="d-none name"><code>use_case_integration.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="packages">Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://biologicalrecordscentre.github.io/STRIDER/">STRIDER</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; terra 1.7.78</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="set-up-a-basic-environment">Set up a basic environment<a class="anchor" aria-label="anchor" href="#set-up-a-basic-environment"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the background</span></span>
<span><span class="va">background</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>nrows<span class="op">=</span><span class="fl">100</span>, ncols<span class="op">=</span><span class="fl">100</span>, nlyrs<span class="op">=</span><span class="fl">1</span>, xmin<span class="op">=</span><span class="op">-</span><span class="fl">1.5</span>, xmax<span class="op">=</span><span class="fl">0</span>, </span>
<span>          ymin<span class="op">=</span><span class="fl">53</span>, ymax<span class="op">=</span><span class="fl">54</span>,crs <span class="op">=</span> <span class="st">"epsg:4326"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">background</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the simulation object</span></span>
<span><span class="va">sim_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SimulationObject.html">SimulationObject</a></span><span class="op">(</span>background <span class="op">=</span> <span class="va">background</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate the environment state</span></span>
<span><span class="va">sim_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_state_env.html">sim_state_env</a></span><span class="op">(</span><span class="va">sim_obj</span>, fun <span class="op">=</span> <span class="va">state_env_gradient</span>, from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the target suitability function</span></span>
<span><span class="va">state_target_suitability_example</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sim_obj</span><span class="op">)</span><span class="op">{</span> </span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">sim_obj</span><span class="op">@</span><span class="va">state_env</span> <span class="op">*</span> <span class="fl">2</span></span>
<span>  <span class="va">out</span><span class="op">[</span><span class="va">out</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">-</span> <span class="va">out</span><span class="op">[</span><span class="va">out</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">/</span><span class="fl">2</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"frog"</span></span>
<span>  <span class="va">out</span> <span class="co"># optimal environment is 0.5</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Apply the target suitability function</span></span>
<span><span class="va">sim_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_state_target_suitability.html">sim_state_target_suitability</a></span><span class="op">(</span><span class="va">sim_obj</span>, <span class="va">state_target_suitability_example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Realise the state</span></span>
<span><span class="va">sim_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_state_target_realise.html">sim_state_target_realise</a></span><span class="op">(</span><span class="va">sim_obj</span>, fun <span class="op">=</span> <span class="va">state_target_realise_binomial</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sampling-method-1-point-based-citizen-science">Sampling Method 1: Point-Based Citizen Science<a class="anchor" aria-label="anchor" href="#sampling-method-1-point-based-citizen-science"></a>
</h2>
<p>Point-based citizen science sampling involves volunteers (citizen
scientists) collecting data at specific point locations within the study
area. In this simulation, we model the effort and data collection
process of citizen scientists who visit multiple locations to observe
and report on target species. This approach captures the variability and
potential biases introduced by non-professional samplers who might have
varying levels of expertise and motivation.</p>
<p>In the following R code, we simulate the effort and data extraction
process for point-based citizen science sampling. We use the sim_effort
function to allocate sampling effort, specifying the number of samplers
and the number of visits each sampler makes. We then use the sim_extract
function to extract the simulated environmental and target data at the
sampling points. Finally, we plot the resulting simulation object to
visualize the sampling effort and observed data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_obj_cit_sci</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/sim_effort.html">sim_effort</a></span><span class="op">(</span><span class="va">sim_obj</span>,<span class="va">effort_basic</span>,n_samplers <span class="op">=</span> <span class="fl">30</span>,n_visits <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sim_detect.html">sim_detect</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_obj_cit_sci</span><span class="op">)</span></span></code></pre></div>
<p><img src="use_case_integration_files/figure-html/unnamed-chunk-3-1.png" width="700"><img src="use_case_integration_files/figure-html/unnamed-chunk-3-2.png" width="700"><img src="use_case_integration_files/figure-html/unnamed-chunk-3-3.png" width="700"><img src="use_case_integration_files/figure-html/unnamed-chunk-3-4.png" width="700"><img src="use_case_integration_files/figure-html/unnamed-chunk-3-5.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="sampling-method-2-transects">Sampling Method 2: Transects<a class="anchor" aria-label="anchor" href="#sampling-method-2-transects"></a>
</h2>
<p>Transect sampling involves systematically sampling along lines
(transects) across the study area. This method is often used in
ecological studies to provide a structured and repeatable way to collect
data across gradients or to cover large areas efficiently. In this
simulation, we model the effort and data collection process along
transects, where each transect consists of a series of points sampled at
regular intervals.</p>
<p>In the following R code, we simulate transect-based sampling effort.
The sim_effort_transect function generates random transects by defining
starting points and orientations within the study area. For each
transect, a series of sampling points are created along the transect
line. The sim_extract function then extracts the simulated environmental
and target data at these sampling points. Finally, we plot the resulting
simulation object to visualize the transect sampling effort and observed
data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_effort_transect</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sim_obj</span>, <span class="va">n_transects</span>, <span class="va">n_transect_points</span>, <span class="va">transect_length</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Extract background information</span></span>
<span>  <span class="va">background</span> <span class="op">&lt;-</span> <span class="va">sim_obj</span><span class="op">@</span><span class="va">background</span></span>
<span>  <span class="va">extent</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">background</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create empty data frame to store effort</span></span>
<span>  <span class="va">transects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_transects</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Generate random starting point for the transect within the extent</span></span>
<span>    <span class="va">start_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, min <span class="op">=</span> <span class="va">extent</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, max <span class="op">=</span> <span class="va">extent</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">start_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, min <span class="op">=</span> <span class="va">extent</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, max <span class="op">=</span> <span class="va">extent</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Generate random angle for the transect</span></span>
<span>    <span class="va">angle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">360</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Calculate end point of the transect</span></span>
<span>    <span class="va">end_x</span> <span class="op">&lt;-</span> <span class="va">start_x</span> <span class="op">+</span> <span class="va">transect_length</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">angle</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">180</span><span class="op">)</span></span>
<span>    <span class="va">end_y</span> <span class="op">&lt;-</span> <span class="va">start_y</span> <span class="op">+</span> <span class="va">transect_length</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">angle</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">180</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Create a sequence of sample points along the transect</span></span>
<span>    <span class="va">sample_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n_transect_points</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">sample_x</span> <span class="op">&lt;-</span> <span class="va">start_x</span> <span class="op">+</span> <span class="va">j</span> <span class="op">*</span> <span class="op">(</span><span class="va">end_x</span> <span class="op">-</span> <span class="va">start_x</span><span class="op">)</span></span>
<span>      <span class="va">sample_y</span> <span class="op">&lt;-</span> <span class="va">start_y</span> <span class="op">+</span> <span class="va">j</span> <span class="op">*</span> <span class="op">(</span><span class="va">end_y</span> <span class="op">-</span> <span class="va">start_y</span><span class="op">)</span></span>
<span>      <span class="va">sample_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html" class="external-link">st_union</a></span><span class="op">(</span><span class="va">sample_points</span>, <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sample_x</span>, <span class="va">sample_y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># Combine into an sf object</span></span>
<span>    <span class="va">transect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span></span>
<span>      sampler <span class="op">=</span> <span class="va">i</span>,</span>
<span>      transect_points <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_transect_points</span>,</span>
<span>      unit <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      geometry <span class="op">=</span> <span class="va">sample_points</span>,</span>
<span>      crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">background</span><span class="op">)</span>,</span>
<span>      row.names <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_transect_points</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_cast.html" class="external-link">st_cast</a></span><span class="op">(</span><span class="st">"LINESTRING"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Append to effort data frame</span></span>
<span>    <span class="va">transects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">transects</span>,<span class="va">transect</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">transects</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sim_obj_transect</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/sim_effort.html">sim_effort</a></span><span class="op">(</span><span class="va">sim_obj</span>,<span class="va">sim_effort_transect</span>,n_transects <span class="op">=</span> <span class="fl">40</span>,n_transect_points <span class="op">=</span> <span class="fl">2</span>,transect_length <span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/sim_detect.html">sim_detect</a></span><span class="op">(</span>realised_extract_fun <span class="op">=</span> <span class="va">max</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_obj_transect</span><span class="op">)</span></span></code></pre></div>
<p><img src="use_case_integration_files/figure-html/unnamed-chunk-4-1.png" width="700"><img src="use_case_integration_files/figure-html/unnamed-chunk-4-2.png" width="700"><img src="use_case_integration_files/figure-html/unnamed-chunk-4-3.png" width="700"><img src="use_case_integration_files/figure-html/unnamed-chunk-4-4.png" width="700"><img src="use_case_integration_files/figure-html/unnamed-chunk-4-5.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="sampling-method-3-sites">Sampling Method 3: Sites<a class="anchor" aria-label="anchor" href="#sampling-method-3-sites"></a>
</h2>
<p>Site-based sampling involves dividing the study area into distinct,
predefined areas (sites) and collecting data within these boundaries. In
this simulation, we use polygonal (square) sites to model the effort and
data collection process. This method is useful for ensuring that data
collection covers the entire study area uniformly and can be
particularly effective for habitat or landscape-level studies.</p>
<p>In the following R code, we simulate site-based sampling effort using
square polygons. The sim_effort_polygons function generates a specified
number of square polygons (sites) within the study area, with each site
having a predefined size. The sim_extract function then extracts the
simulated environmental and target data within these polygons.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Custom function for simulating polygon (square) surveys</span></span>
<span><span class="va">sim_effort_polygons</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sim_obj</span>, <span class="va">n_polygons</span>, <span class="va">polygon_size</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Extract background information</span></span>
<span>  <span class="va">background</span> <span class="op">&lt;-</span> <span class="va">sim_obj</span><span class="op">@</span><span class="va">background</span></span>
<span>  <span class="va">extent</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">background</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create an empty list to store effort data</span></span>
<span>  <span class="va">effort_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_polygons</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Generate random bottom-left corner for the square within the extent</span></span>
<span>    <span class="va">start_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, min <span class="op">=</span> <span class="va">extent</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, max <span class="op">=</span> <span class="va">extent</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">polygon_size</span><span class="op">)</span></span>
<span>    <span class="va">start_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, min <span class="op">=</span> <span class="va">extent</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, max <span class="op">=</span> <span class="va">extent</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">-</span> <span class="va">polygon_size</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Define the corners of the square polygon</span></span>
<span>    <span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="va">start_x</span>, <span class="va">start_y</span>,</span>
<span>      <span class="va">start_x</span> <span class="op">+</span> <span class="va">polygon_size</span>, <span class="va">start_y</span>,</span>
<span>      <span class="va">start_x</span> <span class="op">+</span> <span class="va">polygon_size</span>, <span class="va">start_y</span> <span class="op">+</span> <span class="va">polygon_size</span>,</span>
<span>      <span class="va">start_x</span>, <span class="va">start_y</span> <span class="op">+</span> <span class="va">polygon_size</span>,</span>
<span>      <span class="va">start_x</span>, <span class="va">start_y</span></span>
<span>    <span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Create the polygon</span></span>
<span>    <span class="va">polygon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">polygon_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span></span>
<span>      sampler <span class="op">=</span> <span class="va">i</span>,</span>
<span>      geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="va">polygon</span>, crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">background</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Append to effort list</span></span>
<span>    <span class="va">effort_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">polygon_sf</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Combine all polygons into a single sf object</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">effort_list</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sim_obj_polygons</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/sim_effort.html">sim_effort</a></span><span class="op">(</span><span class="va">sim_obj</span>,<span class="va">sim_effort_polygons</span>,n_polygons <span class="op">=</span> <span class="fl">30</span>,polygon_size <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sim_detect.html">sim_detect</a></span><span class="op">(</span>realised_extract_fun <span class="op">=</span> <span class="va">max</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_obj_polygons</span><span class="op">)</span></span></code></pre></div>
<p><img src="use_case_integration_files/figure-html/unnamed-chunk-5-1.png" width="700"><img src="use_case_integration_files/figure-html/unnamed-chunk-5-2.png" width="700"><img src="use_case_integration_files/figure-html/unnamed-chunk-5-3.png" width="700"><img src="use_case_integration_files/figure-html/unnamed-chunk-5-4.png" width="700"><img src="use_case_integration_files/figure-html/unnamed-chunk-5-5.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="data-integration">Data integration<a class="anchor" aria-label="anchor" href="#data-integration"></a>
</h2>
<p>Here we attempt to do some data integration using the R package
ibis.iSDM</p>
<p>This doesnâ€™t work for some reason</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#https://github.com/iiasa/ibis.iSDM</span></span>
<span><span class="co">#remotes::install_github("IIASA/ibis.iSDM")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ibis.iSDM</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">sim_obj_cit_sci</span><span class="op">@</span><span class="va">detect</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">distribution</span><span class="op">(</span><span class="va">sim_obj</span><span class="op">@</span><span class="va">background</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_predictors</span><span class="op">(</span>env <span class="op">=</span> <span class="va">sim_obj</span><span class="op">@</span><span class="va">state_env</span>,</span>
<span>                 transform <span class="op">=</span> <span class="st">"scale"</span>, </span>
<span>                 derivates <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_biodiversity_poipa</span><span class="op">(</span><span class="va">test_data</span>,</span>
<span>                       name <span class="op">=</span> <span class="st">"Citizen sci data"</span>,</span>
<span>                       field_occurrence <span class="op">=</span> <span class="st">"target_detected"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">engine_glm</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></span><span class="op">(</span>runname <span class="op">=</span>  <span class="st">"test_run"</span>,</span>
<span>        verbose <span class="op">=</span> <span class="cn">T</span>,</span>
<span>        aggregate_observations <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>  </span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simon Rolph.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
