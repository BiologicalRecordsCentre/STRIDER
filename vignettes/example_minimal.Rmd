---
title: "A minimal example"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{A minimal example}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This is a basic example of how this package works.

```{r setup}
library(STRIDER)
library(terra)
library(sf)

#set a seed so it's reproducible
set.seed(42)
```

First, we create a SimulationObject and set up the background SpatRaster from which we use the extent, resolution, and CRS.

```{r state}
# Create the simulation object
sim_obj <- SimulationObject(background = rast(matrix(0, 1000, 1000)))

# Simulate a uniform state of the environment across the background
sim_obj <- sim_state_env_uniform(sim_obj)

# Simulate a uniform state of the target across the background
sim_obj <- sim_state_target_uniform(sim_obj, abundance = 42)

# Plot the state
plot(sim_obj@state_target)
```

Next we simulate effort across the landscape

```{r effort}
# Simulate effort across the landscape
sim_obj <- sim_effort_uniform(sim_obj, n_visits = 100, replace = FALSE)

# Add the sampled locations to the plot
plot(sim_obj@effort$geometry)

```

Next we simulate detections and identifications

```{r detections}
# Simulate detection and identification
sim_obj <- sim_detect_equal(sim_obj, prob = 0.5)

# Plot the non-detections
plot(sim_obj@detect$geometry[sim_obj@detect$detected == FALSE], col = "red", pch = 4)
```

We then simulate whether these detections make are reported

```{r reporting}
# Simulate reporting
sim_obj <- sim_report_equal(sim_obj, prob = 0.8, platform = "iRecord")

# Color reported records as yellow
plot(sim_obj@report$geometry[sim_obj@report$reported], col = "yellow")
```

And we're done. let's have a look at all the objects we have created

```{r review}
print(sim_obj@state_env)
print(sim_obj@state_target)
print(sim_obj@effort)
print(sim_obj@detect)
print(sim_obj@report)
```

